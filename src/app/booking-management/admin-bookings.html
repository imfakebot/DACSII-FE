<div class="admin-bookings-page">
  <header class="page-header">
    <div class="header-content">
      <div class="header-title">
        <h1>ğŸ“Š Quáº£n lÃ½ Äáº·t sÃ¢n</h1>
        <p class="subtitle">Quáº£n lÃ½ vÃ  theo dÃµi táº¥t cáº£ Ä‘Æ¡n Ä‘áº·t sÃ¢n</p>
      </div>
      <div class="header-actions">
        <button class="btn btn-refresh" (click)="load()" [disabled]="loading">
          <span class="icon">â†»</span> Táº£i láº¡i
        </button>
      </div>
    </div>
  </header>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <div class="stat-card stat-card--blue">
      <div class="stat-icon">ğŸ“</div>
      <div class="stat-content">
        <div class="stat-value">{{ bookings.length }}</div>
        <div class="stat-label">Tá»•ng Ä‘Æ¡n</div>
      </div>
    </div>
    <div class="stat-card stat-card--green">
      <div class="stat-icon">âœ…</div>
      <div class="stat-content">
        <div class="stat-value">{{ getStatusCount('confirmed') + getStatusCount('checked-in') + getStatusCount('completed') }}</div>
        <div class="stat-label">HoÃ n thÃ nh</div>
      </div>
    </div>
    <div class="stat-card stat-card--orange">
      <div class="stat-icon">â³</div>
      <div class="stat-content">
        <div class="stat-value">{{ getStatusCount('pending') }}</div>
        <div class="stat-label">Äang chá»</div>
      </div>
    </div>
    <div class="stat-card stat-card--red">
      <div class="stat-icon">âŒ</div>
      <div class="stat-content">
        <div class="stat-value">{{ getStatusCount('cancelled') + getStatusCount('expired') }}</div>
        <div class="stat-label">ÄÃ£ há»§y</div>
      </div>
    </div>
  </div>

  <div *ngIf="error" class="alert alert-error">âš ï¸ {{ error }}</div>

  <section class="card" *ngIf="!loading; else loadingTpl">
    <div class="card-header">
      <h2 class="card-title">Danh sÃ¡ch Ä‘áº·t sÃ¢n</h2>
      <div class="pagination">
        <button class="btn-page" (click)="prev()" [disabled]="!canPrev() || loading">
          <span>â†</span> Trang trÆ°á»›c
        </button>
        <span class="page-info">Trang {{ page }}</span>
        <button class="btn-page" (click)="next()" [disabled]="!canNext() || loading">
          Trang sau <span>â†’</span>
        </button>
      </div>
    </div>
    <div class="table-wrapper">
      <table class="modern-table">
        <thead>
          <tr>
            <th><span class="th-content">ğŸ†” MÃ£ Ä‘Æ¡n</span></th>
            <th><span class="th-content">ğŸ‘¤ KhÃ¡ch hÃ ng</span></th>
            <th><span class="th-content">âš½ SÃ¢n</span></th>
            <th><span class="th-content">ğŸ•’ Thá»i gian</span></th>
            <th><span class="th-content">ğŸ·ï¸ Tráº¡ng thÃ¡i</span></th>
            <th><span class="th-content">âš™ï¸ HÃ nh Ä‘á»™ng</span></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let b of bookings" class="table-row">
            <td><div class="booking-id">{{ b.id.substring(0, 8) }}...</div></td>
            <td>
              <div class="customer-info">
                <div class="customer-name">{{ b.user?.fullName || b.customerName || 'KhÃ¡ch' }}</div>
                <div class="customer-email">{{ b.user?.email || '-' }}</div>
              </div>
            </td>
            <td><div class="field-name">{{ b.field?.name || b.fieldName || '-' }}</div></td>
            <td><div class="time-info">{{ formatTime(b.startTime || b.start_time || b.createdAt) }}</div></td>
            <td>
              <span class="status-badge" [ngClass]="getStatusClass(b.status || b.bookingStatus)">
                <span class="status-dot"></span>
                {{ getStatusLabel(b.status || b.bookingStatus) }}
              </span>
            </td>
            <td>
              <div class="action-buttons">
                <button class="btn-action btn-action--success" (click)="doCheckIn(b)" [disabled]="pendingAction" title="Check-in">
                  <span class="icon">âœ”ï¸</span>
                </button>
                <button class="btn-action btn-action--danger" (click)="doCancel(b)" [disabled]="pendingAction" title="Há»§y Ä‘Æ¡n">
                  <span class="icon">âŒ</span>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <ng-template #loadingTpl>
    <div class="loading">Äang táº£i danh sÃ¡ch...</div>
  </ng-template>
</div>
